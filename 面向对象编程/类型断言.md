# 类型断言

## 引出

将空接口重新转换成对应的类型，就可以叫做类型断言

```go
package main

import "fmt"

type Point struct {
	x int
	y int
}

func main() {
	var a interface{}
	var point Point = Point{1, 2}
	a = point
	var b Point
	//不能直接将a赋值给b
	//b = a
	//类型断言
	b = a.(Point)
	fmt.Println(b)
}

```

b=a.(Point)就是类型断言,表示判断a是否 指向Point类型的变量,如果是就转成Point 类型并赋给b变量,否则报错。

  

## 基本介绍

类型断言：由于接口是一般类型，不知道具体类型，如果要转成具体类型，就需要使用类型断言

> 进行类型断言的时候如果类型不匹配就会报错，断言的时候要确保原来空接口只想的就是要断言的类型

编写一个带检查机制的类型断言：

```go
//带检测的类型断言
	var x interface{}
	var b2 float32 = 1.1
	x = b2
	y, ok := x.(float32)
	if ok {
		fmt.Printf("y的类型为：%T 值为=%v\n", y, y)
	} else {
		fmt.Println("convert fail")
	}
	fmt.Println("继续执行")
```



# 最佳实现

实现USB接口是Phone类型的时候会多执行一个Call方法，而是carmer的时候不会执行，且程序能够正常运行

```go
package main
import "fmt"
type Usb interface {
	Start()
	Stop()
}
type Camera struct {
	Name string
}
type Phone struct {
	Name string
}
type Computer struct {
}
func (c Camera) Start() {
	fmt.Println("相机开始工作")
}
func (c Camera) Stop() {
	fmt.Println("相机停止工作")
}
func (p Phone) Start() {
	fmt.Println("手机开始工作")
}
func (p Phone) Stop() {
	fmt.Println("手机开始工作")
}
func (p Phone) Call() {
	fmt.Println("手机在打电话")
}
func (computer Computer) Working(u Usb) {
	u.Start()
    //断言的部分
	if phone, ok := u.(Phone); ok == true {
		phone.Call()
	}
	u.Stop()
}
func main() {
	var usbArr [3]Usb
	usbArr[0] = Phone{"小米"}
	usbArr[1] = Phone{"vivo"}
	usbArr[2] = Camera{"索尼"}
	var computer Computer
	for _, v := range usbArr {
		computer.Working(v)
		fmt.Println()
	}
}
```

另一个实例，判断输入的数据是什么类型的

```go
package main
import "fmt"
type Student struct {
}
func TypeJudge(items ...interface{}) {
	for index, x := range items {
		//index++
		switch x.(type) {
		case bool:
			fmt.Printf("第%d个参数是bool类型,值是：%v\n", index, x)
		case float32:
			fmt.Printf("第%d个参数是float32类型,值是：%v\n", index, x)
		case float64:
			fmt.Printf("第%d个参数是float64类型,值是：%v\n", index, x)
		case int, int32, int64:
			fmt.Printf("第%d个参数是整数类型,值是：%v\n", index, x)
		case string:
			fmt.Printf("第%d个参数是string类型,值是：%v\n", index, x)
		case Student:
			fmt.Printf("第%d个参数是Student类型,值是：%v\n", index, x)
		case *Student:
			fmt.Printf("第%d个参数是*Student类型,值是：%v\n", index, x)
		default:
			fmt.Printf("第%d个参数的类型不确定,值是：%v\n", index, x)
		}
	}
}

func main() {
	var n1 float32 = 1.1
	var n2 float64 = 1.1
	var n3 int = 10
	var n4 string = "小明"
	n5 := 300
	address := "河南"
	stu1 := Student{}
	stu2 := &Student{}
	TypeJudge(n1, n2, n3, n4, n5, address, stu1, stu2)

}
```

